#!/bin/bash
#
#       Copyright (C) MOXA Inc. All rights reserved.
#       Copyright (C) 2016 Wes Huang <Wes.Huang@moxa.com>
#
#       This software is distributed under the terms of the
#       MOXA License.  See the file COPYING-MOXA for details.
#
#       CR1.4:
#		Authenticator Management
#

check-tpm () {
	if ! lsmod | grep tpm > /dev/null; then
		echo -n -e "Couldn't detect the tpm driver."	
		exit 1
	fi	

	if [ ! -f /dev/tpm0 ]; then 
		echo -n -e "Couldn't detect tpm device node."
		exit 1
	fi
}

case "$1" in
	check-tpm)
		check-tpm
		;;
	*)
		echo -n -e "The parameter is incorrect."
		exit 1
		;;
esac

exit 0

